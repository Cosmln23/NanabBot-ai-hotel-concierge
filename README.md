# AI Hotel Framework

![Python](https://img.shields.io/badge/Python-3.11-blue)
![FastAPI](https://img.shields.io/badge/FastAPI-0.109-green)
![PostgreSQL](https://img.shields.io/badge/PostgreSQL-15-blue)
![License](https://img.shields.io/badge/License-MIT-purple)

A comprehensive, open-source AI platform built exclusively for the hospitality industry. **AI Hotel Framework** combines a dynamic staff dashboard, autonomous AI concierge chatbots, a native billing ecosystem, and pluggable Property Management System (PMS) integrations into a single, multi-tenant scalable software.

---

## ğŸŒŸ Core Features

### ğŸ§  The AI Concierge
- **Anti-Hallucination Engine**: Our LLM is securely confined to use only internal knowledge base chunks and exact hotel policies. It gracefully handles real-time guest requests (towels, room service) and blocks hallucinated amenities.
- **RAG (Retrieval-Augmented Generation)**: Uses vector embeddings to instantly fetch the most relevant FAQ answers and hotel facilities for each specific guest prompt.
- **Multi-Lingual Auto-Translation**: Guests can text in their native language; the AI understands and replies perfectly in the same language. 
- **Auto-Task Assignment**: If a guest asks for extra towels, the AI automatically creates a Staff Ticket (Task) in the dashboard and alerts the front desk.

### ğŸ¢ True Multi-Tenant Architecture
- Run thousands of distinct hotels on a single deployment.
- Each hotel has its own separate knowledge base, team of staff users, AI rules, tone of voice, and integration credentials.
- Automatic routing of WhatsApp and LINE messages to the correct hotel based on QR code scans or dedicated channels.

### ğŸ’¬ Omni-Channel Messaging Providers
Interact with guests where they already are. Supported integrations out of the box:
- **Meta (Official WhatsApp Business API)**: Full support for interactive buttons, templated automated outreach (welcome messages), and session management.
- **Twilio**: Support for both Twilio WhatsApp API and standard Twilio SMS routing.
- **LINE Messaging API**: Native integration for the Asian market, including Quick Reply buttons and rich media.

### ğŸ›ï¸ PMS Sync Engine
Pluggable architecture for Property Management Systems. Automatically pulls guest check-ins, links them to rooms, and pushes conversational events.
- **Cloudbeds**: Full OAuth 2.0 flow with automated token refresh, retrieving modified reservations and real-time stay statuses.
- **Mews**: Advanced Connector API (v2023-06-06) integration, fetching Started/Processed reservations and accurately mapping customer Account IDs.
- **Apaleo**: Client Credentials OAuth 2.0 flow supporting real-time unit parsing and guest data retrieval with intelligent rate-limit handling.
- **Simulation Mode**: Fallback local JSON-based simulator for seamless demonstrations and testing without a live PMS account.

### ğŸ‘¥ Staff Operations Dashboard
- **Unified Inbox**: Staff can view live conversations between the AI and guests, pause the bot, and take over the chat manually (Live Chat).
- **Ticketing & Task Management**: Kanban-style board for tasks automatically generated by the AI or manually opened by staff.
- **AI Settings Control**: Hotel owners can independently customize the bot's tone (Professional vs. Friendly), define restricted topics, and upload their own FAQs.

### ğŸ’³ Subscriptions & Billing
- **Stripe Integration**: Native, ready-to-use payment integration built directly into the UI.
- **Multi-Tier Logic**: Manage Free Trials, Basic, and Pro tiers. Automated chron jobs warn users of expiring trials and automatically disable the AI (while preserving data) upon expiration.

### ğŸ”’ Security & GDPR Compliance
- **Data Retention (GDPR)**: A background worker automatically purges old chat messages and anonymizes Guest PII (Personally Identifiable Information) 90 days after check-out.
- **Bank-Grade Session Security**: JWT securely stored in `HttpOnly` and `Secure` cookies. Zero token exposure in URLs or `localStorage`.
- **Encrypted Credentials**: All 3rd party API keys (Stripe, Cloudbeds, OpenAI) are encrypted at rest using AES (SQLAlchemy `StringEncryptedType`).
- **Webhook Rate-Limiting**: Strictly indexed endpoints protected against spoofing and spam.

---

## ğŸ—ï¸ Architecture & Stack

- **Backend Logic**: Python 3.11+ / FastAPI / SQLAlchemy (ORM)
- **Database**: PostgreSQL (Relational + Vector extensions if configured)
- **Frontend Engine**: Jinja2 HTML Templates + Vanilla Javascript / TailwindCSS styling for maximum speed and simplicity.
- **Asynchronous Queue**: Redis & RQ (Redis Queue) for background polling, syncs, and heavy AI calls.
- **AI Brain**: OpenAI API (`gpt-4o-mini` default) wrapped in structured tool-calling.

---

## ğŸš€ Getting Started

The platform runs natively on Python with background workers and caching.

### 1. Prerequisites
- Python 3.11+
- PostgreSQL database (running locally or remote)
- Redis server (running locally or remote)

### 2. Environment Setup
```bash
cp .env.example .env
nano .env
```
Provide your Database URL, Redis URL, OpenAI API Key, and set `DOMAIN_NAME`.

### 3. Installation
```bash
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
```

### 4. Database Migrations
Initialize your database schema using Alembic:
```bash
alembic upgrade head
```

### 5. Deploy
You need to run both the web server and the background worker simultaneously.

**Terminal 1 (Web Server):**
```bash
source venv/bin/activate
uvicorn app.main:app --host 0.0.0.0 --port 8000
```

**Terminal 2 (Background Worker & Cron Jobs):**
```bash
source venv/bin/activate
python run_worker.py
```

---

## ğŸ”‘ Admin Setup
Launch securely into the admin portal via your browser. The root URL automatically routes to the login panel:
`http://localhost:8000/` -> `/ui/admin/login`

> **Note:** Initial login details (the SuperAdmin or first Hotel Owner) should be seeded securely via CLI interaction, a custom script, or direct DB insertion depending on your deployment flow.

## ğŸ“– API Documentation
Full, interactive API documentation is automatically generated via Swagger UI once the server is running.
Navigate to `http://localhost:8000/docs` to view the comprehensive spec.

---

## ğŸ¤ Contributing
We welcome pull requests! For major architectural changes or new PMS integrations, please open an issue first to discuss what you would like to change. 

## ğŸ“„ License
[MIT](https://choosealicense.com/licenses/mit/)
